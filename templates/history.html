{% extends 'base.html' %}
{% block content %}
<h2>History</h2>
{% if items and items|length > 0 %}
  <div class="row g-3">
    {% for row in items %}
      <div class="col-12 col-md-6 col-lg-4">
        <div class="card bg-dark border-secondary h-100">
          <img src="{{ url_for('serve_output', filename=row['output_filename']) }}" class="card-img-top" alt="output thumbnail">
          <div class="card-body d-flex flex-column">
            <div class="fw-semibold mb-1">{{ row['output_filename'] }}</div>
            <small class="text-muted mb-3">Source: {{ row['filename'] }} | {{ row['created_at'] }}</small>
            <div class="mt-auto d-flex gap-2">
              <a class="btn btn-sm btn-outline-primary" href="{{ url_for('serve_output', filename=row['output_filename']) }}" download>Download</a>
              <a class="btn btn-sm btn-outline-light" href="/try-on">Re-try</a>
              <form action="{{ url_for('delete_history', item_id=row['id']) }}" method="post" onsubmit="return confirm('Delete this item?');">
                <button class="btn btn-sm btn-outline-danger" type="submit">Delete</button>
              </form>
            </div>
          </div>
        </div>
      </div>
    {% endfor %}
  </div>
{% else %}
  <p class="text-muted">No history yet. Upload a photo on Try-On.</p>
{% endif %}
{% endblock %}


